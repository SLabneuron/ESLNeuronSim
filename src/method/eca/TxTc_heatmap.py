import pandas as pd
import matplotlib.pyplot as plt
from matplotlib import cm
from matplotlib.colors import ListedColormap
import numpy as np

from matplotlib.colors import LinearSegmentedColormap

# ---- data ----
# normal TxTy sweep (set 1)
data1 = [
    [0.014142136, 0.017320508, 91.01, 1.01],
    [0.042426407, 0.017320508, 98.05, 8.05],
    [0.070710678, 0.017320508, 98.47, 8.47],
    [0.098994949, 0.017320508, 98.39, 8.39],
    [0.127279221, 0.017320508, 98.77, 8.77],
    [0.014142136, 0.051961524, 91.53, 1.53],
    [0.042426407, 0.051961524, 97.94, 7.94],
    [0.070710678, 0.051961524, 98.97, 8.97],
    [0.098994949, 0.051961524, 98.39, 8.39],
    [0.127279221, 0.051961524, 99.21, 9.21],
    [0.014142136, 0.08660254, 90.54, 0.54],
    [0.042426407, 0.08660254, 97.52, 7.52],
    [0.070710678, 0.08660254, 98.39, 8.39],
    [0.098994949, 0.08660254, 98.5, 8.5],
    [0.127279221, 0.08660254, 99.07, 9.07],
    [0.014142136, 0.121243557, 90.15, 0.15],
    [0.042426407, 0.121243557, 97.04, 7.04],
    [0.070710678, 0.121243557, 98.66, 8.66],
    [0.098994949, 0.121243557, 98.73, 8.73],
    [0.127279221, 0.121243557, 98.68, 8.68],
    [0.014142136, 0.155884573, 89.79, 0.0],
    [0.042426407, 0.155884573, 96.9, 6.9],
    [0.070710678, 0.155884573, 98.6, 8.6],
    [0.098994949, 0.155884573, 98.85, 8.85],
    [0.127279221, 0.155884573, 99.16, 9.16],
]

# rotated TxTy sweep (set 1)
data2 = [
    [0.014142136, 0.017320508, 92.12, 2.12],
    [0.042426407, 0.017320508, 98.52, 8.52],
    [0.070710678, 0.017320508, 98.82, 8.82],
    [0.098994949, 0.017320508, 98.39, 8.39],
    [0.127279221, 0.017320508, 98.76, 8.76],
    [0.014142136, 0.051961524, 93.04, 3.04],
    [0.042426407, 0.051961524, 98.51, 8.51],
    [0.070710678, 0.051961524, 99.17, 9.17],
    [0.098994949, 0.051961524, 98.68, 8.68],
    [0.127279221, 0.051961524, 98.89, 8.89],
    [0.014142136, 0.08660254, 92.03, 2.03],
    [0.042426407, 0.08660254, 98.33, 8.33],
    [0.070710678, 0.08660254, 98.91, 8.91],
    [0.098994949, 0.08660254, 98.77, 8.77],
    [0.127279221, 0.08660254, 99.16, 9.16],
    [0.014142136, 0.121243557, 91.73, 1.73],
    [0.042426407, 0.121243557, 98.15, 8.15],
    [0.070710678, 0.121243557, 98.82, 8.82],
    [0.098994949, 0.121243557, 98.91, 8.91],
    [0.127279221, 0.121243557, 98.8, 8.8],
    [0.014142136, 0.155884573, 90.87, 0.87],
    [0.042426407, 0.155884573, 97.83, 7.83],
    [0.070710678, 0.155884573, 98.88, 8.88],
    [0.098994949, 0.155884573, 98.7, 8.7],
    [0.127279221, 0.155884573, 98.92, 8.92],
]

# normal TxTy sweep (set 2)
data3 = [
    [0.01414213562373095, 0.017320508075688773, 89.67, 0],
    [0.04242640687119285, 0.017320508075688773, 92.93, 2.93],
    [0.07071067811865477, 0.017320508075688773, 90.41, 0.41],
    [0.09899494936611666, 0.017320508075688773, 90.78, 0.78],
    [0.12727922061357855, 0.017320508075688773, 90.83, 0.83],

    [0.01414213562373095, 0.05196152422706631, 90.76, 0.76],
    [0.04242640687119285, 0.05196152422706631, 90.11, 0.11],
    [0.07071067811865477, 0.05196152422706631, 93.55, 3.55],
    [0.09899494936611666, 0.05196152422706631, 93.38, 3.38],
    [0.12727922061357855, 0.05196152422706631, 93.07, 3.07],

    [0.01414213562373095, 0.08660254037844387, 89.03, 0],
    [0.04242640687119285, 0.08660254037844387, 94.29, 4.29],
    [0.07071067811865477, 0.08660254037844387, 92.49, 2.49],
    [0.09899494936611666, 0.08660254037844387, 94.26, 4.26],
    [0.12727922061357855, 0.08660254037844387, 94.51, 4.51],

    [0.01414213562373095, 0.12124355652982141, 87.99, 0],
    [0.04242640687119285, 0.12124355652982141, 94.59, 4.59],
    [0.07071067811865477, 0.12124355652982141, 93.34, 3.34],
    [0.09899494936611666, 0.12124355652982141, 93.74, 3.74],
    [0.12727922061357855, 0.12124355652982141, 94.48, 4.48],

    [0.01414213562373095, 0.15588457268119893, 89.57, 0],
    [0.04242640687119285, 0.15588457268119893, 95.07, 5.07],
    [0.07071067811865477, 0.15588457268119893, 95.07, 5.07],
    [0.09899494936611666, 0.15588457268119893, 94.01, 4.01],
    [0.12727922061357855, 0.15588457268119893, 93.48, 3.48],
]

# rotated TxTy sweep (set 2)
data4 = [
    [0.014142135623730952, 0.017320508075688773, 90.26, 0.26],
    [0.042426406871192854, 0.017320508075688773, 92.58, 2.58],
    [0.07071067811865477,  0.017320508075688773, 89.65, 0.00],
    [0.09899494936611666,  0.017320508075688773, 90.77, 0.77],
    [0.12727922061357855,  0.017320508075688773, 90.66, 0.66],

    [0.014142135623730952, 0.05196152422706631, 90.24, 0.24],
    [0.042426406871192854, 0.05196152422706631, 91.22, 1.22],
    [0.07071067811865477,  0.05196152422706631, 93.70, 3.70],
    [0.09899494936611666,  0.05196152422706631, 93.29, 3.29],
    [0.12727922061357855,  0.05196152422706631, 92.65, 2.65],

    [0.014142135623730952, 0.08660254037844387, 87.46, 0.00],
    [0.042426406871192854, 0.08660254037844387, 95.31, 5.31],
    [0.07071067811865477,  0.08660254037844387, 92.67, 2.67],
    [0.09899494936611666,  0.08660254037844387, 94.48, 4.48],
    [0.12727922061357855,  0.08660254037844387, 94.27, 4.27],

    [0.014142135623730952, 0.12124355652982141, 88.99, 0.00],
    [0.042426406871192854, 0.12124355652982141, 94.63, 4.63],
    [0.07071067811865477,  0.12124355652982141, 93.96, 3.96],
    [0.09899494936611666,  0.12124355652982141, 93.35, 3.35],
    [0.12727922061357855,  0.12124355652982141, 94.30, 4.30],

    [0.014142135623730952, 0.15588457268119893, 90.84, 0.84],
    [0.042426406871192854, 0.15588457268119893, 95.24, 5.24],
    [0.07071067811865477,  0.15588457268119893, 95.17, 5.17],
    [0.09899494936611666,  0.15588457268119893, 94.31, 4.31],
    [0.12727922061357855,  0.15588457268119893, 93.48, 3.48],
]


""" 4.2 """

# Tx vs theta sweep (set 1)
data5 = [
    [0.014142135623730952, 1, 92.03, 2.03],
    [0.042426406871192854, 1, 98.33, 8.33],
    [0.07071067811865477,  1, 98.91, 8.91],
    [0.09899494936611666,  1, 98.77, 8.77],
    [0.12727922061357855,  1, 99.16, 9.16],

    [0.014142135623730952, 2, 94.91, 4.91],
    [0.042426406871192854, 2, 98.86, 8.86],
    [0.07071067811865477,  2, 99.19, 9.19],
    [0.09899494936611666,  2, 99.12, 9.12],
    [0.12727922061357855,  2, 98.92, 8.92],

    [0.014142135623730952, 3, 96.72, 6.72],
    [0.042426406871192854, 3, 99.37, 9.37],
    [0.07071067811865477,  3, 99.51, 9.51],
    [0.09899494936611666,  3, 99.57, 9.57],
    [0.12727922061357855,  3, 99.44, 9.44],

    [0.014142135623730952, 4, 98.15, 8.15],
    [0.042426406871192854, 4, 99.61, 9.61],
    [0.07071067811865477,  4, 99.71, 9.71],
    [0.09899494936611666,  4, 99.52, 9.52],
    [0.12727922061357855,  4, 99.50, 9.50],

    [0.014142135623730952, 5, 98.96, 8.96],
    [0.042426406871192854, 5, 99.68, 9.68],
    [0.07071067811865477,  5, 99.69, 9.69],
    [0.09899494936611666,  5, 99.46, 9.46],
    [0.12727922061357855,  5, 99.56, 9.56],
]


# Tx vs theta sweep (set 2)
data6 = [
    [0.014142135623730952, 1, 87.46, 0.00],
    [0.042426406871192854, 1, 95.31, 5.31],
    [0.07071067811865477,  1, 92.67, 2.67],
    [0.09899494936611666,  1, 94.48, 4.48],
    [0.12727922061357855,  1, 94.27, 4.27],

    [0.014142135623730952, 2, 89.29, 0.00],
    [0.042426406871192854, 2, 95.30, 5.30],
    [0.07071067811865477,  2, 92.90, 2.90],
    [0.09899494936611666,  2, 94.72, 4.72],
    [0.12727922061357855,  2, 94.29, 4.29],

    [0.014142135623730952, 3, 91.05, 1.05],
    [0.042426406871192854, 3, 95.24, 5.24],
    [0.07071067811865477,  3, 93.68, 3.68],
    [0.09899494936611666,  3, 94.79, 4.79],
    [0.12727922061357855,  3, 94.01, 4.01],

    [0.014142135623730952, 4, 90.79, 0.79],
    [0.042426406871192854, 4, 95.23, 5.23],
    [0.07071067811865477,  4, 94.29, 4.29],
    [0.09899494936611666,  4, 94.87, 4.87],
    [0.12727922061357855,  4, 93.69, 3.69],

    [0.014142135623730952, 5, 90.33, 0.33],
    [0.042426406871192854, 5, 95.33, 5.33],
    [0.07071067811865477,  5, 94.46, 4.46],
    [0.09899494936611666,  5, 94.82, 4.82],
    [0.12727922061357855,  5, 92.88, 2.88],
]


# Ty vs theta sweep (set 1)
data7 = [

    [0.017320508075688773, 1, 98.82, 8.82],
    [0.05196152422706631,  1, 99.17, 9.17],
    [0.08660254037844387,  1, 98.91, 8.91],
    [0.12124355652982141,  1, 98.82, 8.82],
    [0.15588457268119893,  1, 98.88, 8.88],

    [0.017320508075688773, 2, 99.19, 9.19],
    [0.05196152422706631,  2, 99.40, 9.40],
    [0.08660254037844387,  2, 99.19, 9.19],
    [0.12124355652982141,  2, 99.21, 9.21],
    [0.15588457268119893,  2, 99.16, 9.16],

    [0.017320508075688773, 3, 99.50, 9.50],
    [0.05196152422706631,  3, 99.27, 9.27],
    [0.08660254037844387,  3, 99.51, 9.51],
    [0.12124355652982141,  3, 99.69, 9.69],
    [0.15588457268119893,  3, 99.66, 9.66],

    [0.017320508075688773, 4, 99.53, 9.53],
    [0.05196152422706631,  4, 99.61, 9.61],
    [0.08660254037844387,  4, 99.71, 9.71],
    [0.12124355652982141,  4, 99.66, 9.66],
    [0.15588457268119893,  4, 99.52, 9.52],

    [0.017320508075688773, 5, 99.44, 9.44],
    [0.05196152422706631,  5, 99.69, 9.69],
    [0.08660254037844387,  5, 99.69, 9.69],
    [0.12124355652982141,  5, 99.76, 9.76],
    [0.15588457268119893,  5, 99.61, 9.61],
]


# Ty vs theta sweep (set 2)
data8 = [
    [0.017320508075688773, 1, 89.65, 0.00],
    [0.05196152422706631,  1, 93.70, 3.70],
    [0.08660254037844387,  1, 92.67, 2.67],
    [0.12124355652982141,  1, 93.96, 3.96],
    [0.15588457268119893,  1, 95.17, 5.17],

    [0.017320508075688773, 2, 89.95, 0.00],
    [0.05196152422706631,  2, 93.91, 3.91],
    [0.08660254037844387,  2, 92.90, 2.90],
    [0.12124355652982141,  2, 94.80, 4.80],
    [0.15588457268119893,  2, 95.31, 5.31],

    [0.017320508075688773, 3, 89.97, 0.00],
    [0.05196152422706631,  3, 94.02, 4.02],
    [0.08660254037844387,  3, 93.68, 3.68],
    [0.12124355652982141,  3, 95.50, 5.50],
    [0.15588457268119893,  3, 95.16, 5.16],

    [0.017320508075688773, 4, 89.91, 0.00],
    [0.05196152422706631,  4, 94.60, 4.60],
    [0.08660254037844387,  4, 94.29, 4.29],
    [0.12124355652982141,  4, 96.02, 6.02],
    [0.15588457268119893,  4, 95.64, 5.64],

    [0.017320508075688773, 5, 89.61, 0.00],
    [0.05196152422706631,  5, 94.28, 4.28],
    [0.08660254037844387,  5, 94.46, 4.46],
    [0.12124355652982141,  5, 95.89, 5.89],
    [0.15588457268119893,  5, 95.52, 5.52],
]

base = cm.get_cmap("Reds_r")

cmap = LinearSegmentedColormap.from_list(
    "soft_reds",
    [
        (0.00, base(0.00)),   # 0 : しっかり赤（悪い）
        (0.50, base(0.75)),   # 4 : かなり薄い赤（ほぼ白）
        (1.00, base(1.00)),   # 10: 完全白（良い）
    ]
)

df = pd.DataFrame(data4, columns=["x", "y", "v3", "v4"])

# ---- pivot to heatmap ----
Z = df.pivot(index="y", columns="x", values="v4")

plt.imshow(Z.values, origin="lower", aspect="auto", vmin=0, vmax=10, cmap=cmap)
plt.xticks(range(len(Z.columns)), Z.columns, rotation=45)
plt.yticks(range(len(Z.index)), Z.index)
plt.xlabel("x")
plt.ylabel("y")
plt.colorbar(label="4th column value")
plt.tight_layout()
plt.show()